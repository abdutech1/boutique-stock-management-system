generator client {
  provider = "prisma-client"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "mysql"
}



model category {
  id        Int      @id @default(autoincrement())
  name      String   @unique
  isActive  Boolean  @default(true)

  pricecategory pricecategory[]
}


model expense {
  id          Int      @id @default(autoincrement())
  description String
  amount      Float
  weekStart   DateTime
  weekEnd     DateTime
  createdAt   DateTime @default(now())
}

model pricecategory {
  id         Int      @id @default(autoincrement())
  fixedPrice Float
  categoryId Int
  category   category @relation(fields: [categoryId], references: [id], map: "PriceCategory_categoryId_fkey")
  sale       sale[]
  stock      stock?

  @@index([categoryId], map: "PriceCategory_categoryId_fkey")
}

model salarypayment {
  id        Int      @id @default(autoincrement())
  amount    Float
  weekStart DateTime
  weekEnd   DateTime
  createdAt DateTime @default(now())
  userId    Int
  user      user     @relation(fields: [userId], references: [id], map: "SalaryPayment_userId_fkey")

  @@index([userId], map: "SalaryPayment_userId_fkey")
}




model sale {
  id              Int           @id @default(autoincrement())
  soldPrice       Float
  quantity        Int
  bonus           Float
  createdAt       DateTime      @default(now())
  updatedAt       DateTime      @updatedAt

  status          sale_status   @default(DRAFT)

  employeeId      Int
  priceCategoryId Int

  user            user          @relation(fields: [employeeId], references: [id])
  pricecategory   pricecategory @relation(fields: [priceCategoryId], references: [id])
}


enum sale_status {
  DRAFT
  CONFIRMED
  CANCELLED
}


model stock {
  id              Int           @id @default(autoincrement())
  purchasePrice   Float
  quantity        Int
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  priceCategoryId Int           @unique(map: "Stock_priceCategoryId_key")
  pricecategory   pricecategory @relation(fields: [priceCategoryId], references: [id], map: "Stock_priceCategoryId_fkey")
}



model user {
  id            Int             @id @default(autoincrement())
  name          String
  phoneNumber   String          @unique
  role          user_role
  baseSalary    Float?
  isActive      Boolean         @default(true)

  createdAt     DateTime        @default(now())
  updatedAt     DateTime        @updatedAt

  salarypayment salarypayment[]
  sale          sale[]
}


enum user_role {
  OWNER
  EMPLOYEE
}
